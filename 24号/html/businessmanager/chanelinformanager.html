<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>交易渠道信息管理</title>
	<link rel="stylesheet" type="text/css" href="../style/base.css">
	<link rel="stylesheet" type="text/css" href="../style/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="../style/style.css">
	
</head>

<body style="">
	<div class="ui-info-box">
    <div class="ui-crumbs">
    	 <span>当前位置：</span><a href="#">交易管理</a><em>></em><span>交易渠道信息管理</span>
    </div>

		<div class="ui-datagrid-wrap">
			<!-- 搜索 -->
			<div class="search-wrap">
				<form  id="search-ff" class="ui-search-form">
					<ul class="search-list fn-clear">
						
						<li>
							<label class="name">支付渠道</label>
							<span class="textbox"><input class="textbox-text textbox-prompt" type="text" maxlength="20"/></span>
						</li>
						<li>
							<label class="name">状态</label>
							<select class="ui-combobox" name="" id="transaceAmount">
								<option value="" selected ="selected">全部</option>
								<option value="">禁用</option>
								<option value="">正常</option>
							</select>	
						</li>
						<li class="btn-group">
							<a href="javascript:void(0)" class="search-btn" onclick="submitForm()">搜索</a>
				    		<a href="javascript:void(0)" class="search-btn" onclick="clearForm()">重置</a>
						</li>
					</ul>
				</form>
			</div>
			<!-- 搜索end -->
			<!-- 列表 -->
			<div class="list-item fn-clear">
				<button class="search-btn policy-newcontent" id="policyNewContent">新增</button>
				<table id="dg-list" class="easyui-datagrid"  style="margin-right:10px;">	
				</table>
			</div>
			<!-- 列表end -->
			
		</div>
		<!--新增弹出框start-->

		<div id="dlgConfirm" class="easyui-dialog ui-dlg-confirm ui-newalert-box"  data-options="iconCls:'icon-save',modal:true,closed: true">
			<h3 class="ui-dlg-tit">新增支付渠道</h3>
			<form action="">
				<ul class="ui-dlg-dtl">
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道名称：</label>
						<span  class="ui-newcontent-item-span textbox">
							<input class="textbox-text easyui-validatebox ui-new-paychannel" type="text" name="chanelMaskName" value="" id="newNameContent" data-options="required:true,validType:'chinese'" maxlength="20" missingMessage="请输入支付渠道名称"/>
						</span>
					</li>
				  	<li class="ui-newcontent-item">
				  		<label class="ui-newcontent-item-label">合作时间：</label>
				  		<span  class="ui-newcontent-item-span">
				  			<input  class="easyui-datebox" vlaue="" id="startchanelTimeStart" >
				  			<em>至</em>
				  			<input class="easyui-datebox" vlaue="" validType="md['#startchanelTimeStart']" id="beginchanelTimeEnd">
				  		</span>
				  	</li>
				  	<li>
					  	<span class="showMessage2">	</span>
					</li>
				</ul>
				<input type="button" class="ui-dlgOk-btn" value="下一步" id="newContentNext"/>
		    	<input type="button" class="ui-dlgCancel-btn" value="取消"/>
			</form>  
		</div>
		<!--新增弹出框end-->
		<!--新增弹出框下一步start-->
			<div id="dlgConfirmNext" class="easyui-dialog ui-dlg-confirm ui-newalert-box"  data-options="iconCls:'icon-save',modal:true,closed: true">
				<h3 class="ui-dlg-tit">新增支付渠道</h3>
				<ul class="ui-dlg-dtl">
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道名称：</label>
						<span  class="ui-newcontent-item-span" id="ui-payment-name"></span>
					</li>
				  	<li class="ui-newcontent-item">
				  		<label class="ui-newcontent-item-label">合作时间：</label>
				  		<span  class="ui-newcontent-item-span">
				  			<em id="ui-payment-starttime">2015-05-01</em> 至 <em id="ui-payment-endtime">2016-05-01</em>
				  		</span>
				  	</li>
				  	
			   <input type="button" class="ui-dlgOk-btn" value="完成并保持" id="newContentSave"/>
			  <input type="button" class="ui-dlgCancel-btn" value="返回修改" id="newContentBack"/>
			</div>
		<!--新增弹出框下一步end-->


		<!--支付渠道名称弹出框start-->
			<div id="dlgConfirmShow" class="easyui-dialog ui-dlg-confirm ui-newalert-box"  data-options="iconCls:'icon-save',modal:true,closed: true">
				<h3 class="ui-dlg-tit">查看支付渠道</h3>
				<ul class="ui-dlg-dtl">
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道ID：</label>
						<span  class="ui-newcontent-item-span" id="payChannelId">000009</span>
					</li>
				  	<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道名称：</label>
						<span  class="ui-newcontent-item-span" id="payChannelName">支付宝</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">合作时间：</label>
						<span  class="ui-newcontent-item-span" id="payChannelTime">2015-04-20至2015-05-01</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">开关：</label>
						<span  class="ui-newcontent-item-span" id="payChannelState">开启</span>
					</li>
			   <input type="button" class="ui-dlgCancel-btn " value="返回" id="paymentBack"/>
			  <input type="button" class=" ui-dlgOk-btn" value="编辑" id="paymentEditor"/>
			</div>
		<!--支付渠道名称弹出框end-->
		<!--支付渠道名称下一步弹出框start-->
			<div id="dlgConfirmNextShow" class="easyui-dialog ui-dlg-confirm ui-newalert-box"  data-options="iconCls:'icon-save',modal:true,closed: true">
				<h3 class="ui-dlg-tit">查看支付渠道</h3>
				<ul class="ui-dlg-dtl">
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道ID：</label>
						<span  class="ui-newcontent-item-span" id="editorId">000009</span>
					</li>
				  	<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道名称：</label>
						<span  class="ui-newcontent-item-span textbox">
						<input class="textbox-text textbox-prompt easyui-validatebox ui-new-paychannel" type="text" name="chanelMaskName" value="" id="editorName" data-options="required:true,validType:'chinese'" maxlength="20"/>
						
					</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">合作时间：</label>
				  		<span  class="ui-newcontent-item-span">
				  			<input  class="easyui-datebox" vlaue="" validType="md['#editorTimeStart']" id="editorTimeStart" >
				  			<em>至</em>
				  			<input class="easyui-datebox" vlaue="" validType="md['#editorTimeEnd']" id="editorTimeEnd">
				  		</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">开关：</label>
						<span  class="ui-newcontent-item-span" id="editorState">
						<em class="switch-style"><input type="radio" name="dredgeRadio" value="开启">开启</em><em class="switch-style"><input type="radio" name="dredgeRadio" value="关闭">关闭</em></span>
					</li>
			   <input type="button" class="ui-dlgOk-btn" value="下一步" id="editorNext"/>
			  <input type="button" class="ui-dlgCancel-btn" value="取消"/>
			</div>
		<!--支付渠道名称下一步弹出框end-->
		<!--支付渠道名称保存信息start-->
			<div id="dlgConfirmSaveShow" class="easyui-dialog ui-dlg-confirm ui-newalert-box"  data-options="iconCls:'icon-save',modal:true,closed: true">
				<h3 class="ui-dlg-tit">查看支付渠道保存</h3>
				<ul class="ui-dlg-dtl">
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道ID：</label>
						<span  class="ui-newcontent-item-span" id="paySaveId">000009</span>
					</li>
				  	<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">支付渠道名称：</label>
						<span  class="ui-newcontent-item-span" id="paySaveName">支付宝</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">合作时间：</label>
						<span  class="ui-newcontent-item-span" id="paySaveTime">2015-04-20至2015-05-01</span>
					</li>
					<li class="ui-newcontent-item">
						<label class="ui-newcontent-item-label">开关：</label>
						<span  class="ui-newcontent-item-span" id="paySaveState">开启</span>
					</li>
			   <input type="button" class=" ui-dlgOk-btn" value="保存并返回" id="editorSave"/>
			  <input type="button" class=" ui-dlgCancel-btn" value="返回修改" id="editorBack"/>
			</div>
		<!--支付渠道名称保存信息end-->

	</div>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../js/base.js"></script>
	<script>
	$(function(){
		validExtend();
		//列表
		$("#dg-list").datagrid({
			url:'bussiness_infor.json',
			method:'post',
			fitColumns:true,
			rownumbers:true,
			nowrap: true,//当数据长度超出列宽时将会自动截取
			//idField:'userid',//id字段
			//sortName:'userid',//当数据表格初始化时以哪一列来排序
			//sortOrder:'desc',//'asc'/'desc'（正序/倒序）
			//remoteSort: false,//定义是否通过远程服务器对数据排序
			resizable:false,
			checkOnSelect:false,
			pagination:true,
			pageSize:10,
			columns:[[
				{field:'agentAreaCity',align:'center',width:"22%",title:'支付渠道ID',sortable:true},
				{field:'agentAreaCityName',align:'center',width:"20%",title:'支付渠道名称',
						formatter:function(value,rec){
						
							return '<a class="payment-name-all" href="javascript:void(0);" onclick="showAlert(\'dlgConfirmShow\');">'+value+'</a>';
						}
				},
				{field:'truename',align:'center',width:"34%",title:'合作时间'},
				{field:'opt',align:'center',width:"22%",title:'状态'}
			]],
			queryParams: eb.form2Json("search-ff"),
	    	loadFilter:function(data){
           	 	return eb.loadFilter(data);    //自定义过滤方法
	     	},
	      	onLoadSuccess:pageCls
		});
		//分页
		pageAction();


		
		//点击新增
		$("#policyNewContent").click(function(event) {

			//清空内容操作
			$("#newNameContent").val(""),
			$("#startchanelTimeStart").datebox('setValue', "");
			$("#beginchanelTimeEnd").datebox('setValue', "");
			$(".showMessge2").text("");
			showAlert("dlgConfirm");
		});
		//新增--点击下一步显示信息
		$("#newContentNext").click(function(event) {
			
			var chanelName = $("#newNameContent").val(),
				concurTimeStart = $("#startchanelTimeStart").datebox("getValue"),
				concurTimeEnd = $("#beginchanelTimeEnd").datebox("getValue"),
				target = $("#dlgConfirm").find(".showMessage2"),
				str = '',f = $(this).parents('form'),isflag = true;
		
			if(concurTimeStart == "" || concurTimeEnd ==""){
				str = '请选择合作时间';
				isflag = false;
			}
			target.text(str);
			if(f.form('validate') && isflag){
				$("#ui-payment-name").text(chanelName);
				$("#ui-payment-starttime").text(concurTimeStart);
				$("#ui-payment-endtime").text(concurTimeEnd);
				showAlert("dlgConfirmNext");
				$("#dlgConfirm").dialog("close");
			}
			
		});

		//新增--完成并保存信息
		$("#newContentSave").click(function(event) {
			$("#dlgConfirmNext").dialog("close");
		});

		//新增--返回编辑
		$("#newContentBack").click(function(event) {
			showAlert("dlgConfirm");
		});


		//1.编辑
		$("#paymentEditor").click(function(event) {
			var id = $("#payChannelId").text(),
				name = $("#payChannelName").text(),
				date = $("#payChannelTime").text(),
				state = $("#payChannelState").text(),
				radioState = 0;
			$("#editorId").text(id);
			$("#editorName").val(name);
		
			radioState = state == "开启" ? 0 : 1;
		
			var stardate=date.substring(0,10);
			var enddtate=date.substring(11);
			
			$("#editorTimeStart").datebox('setValue',stardate);
			$("#editorTimeEnd").datebox('setValue', enddtate);
			$("#editorState").find("input").eq(radioState).prop("checked",true);
			$("#dlgConfirmShow").dialog("close");
			showAlert("dlgConfirmNextShow");
		});


		//2.点击下一步显示修改界面
		$("#editorNext").click(function(event) {
			var id = $("#editorId").text(),
				name = $("#editorName").val(),
				state = $("#editorState").find("input[name=dredgeRadio]:checked").val(),
				dateStart = $("#editorTimeStart").datebox('getValue'),
				dateEnd = $("#editorTimeEnd").datebox('getValue');
			
			$("#paySaveId").text(id);
			$("#paySaveName").text(name);
			$("#paySaveTime").text(dateStart+"至"+dateEnd);
			$("#paySaveState").text(state);
			$("#dlgConfirmNextShow").dialog("close");
			showAlert("dlgConfirmSaveShow");
		});

		//3.保存信息
		$("#editorSave").click(function(event) {
	
			$("#dlgConfirmSaveShow").dialog("close");
		});
		
		//4.返回编辑修改
		$("#editorBack").click(function(event) {
			showAlert("dlgConfirmNextShow");
		});
			
		
   });
	function submitForm(){
		if($('#search-ff').form('validate')){
			    //eb.backToFstPage("#datagrid");
				$("#dg-list").datagrid({queryParams : eb.form2Json("search-ff")});
				 pageAction();
			}
	}
	function clearForm(){
		$("#search-ff").form('clear');
	}
	
	</script>
</body>
</html>
